---
title: "REddyProc for Eddy Covariance Data Analysis"
author: "Yusri Yusup"
date: "`r Sys.Date()`"
output: 
  powerpoint_presentation:
    reference_doc: my_template.pptx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Acknowledgements

This content was built on top of the talk by Thomas Wutzler. Credit goes to him for his: 

1. presentation (https://www.youtube.com/watch?v=-b0vc4u8kls&t=354s) and 
2. material at https://github.com/bgctw/EGU19EddyCourse/blob/master/Source/DEGebExample_complete.Rmd.

# Prerequisites

## Knowledge

It would be easier for you to follow the talk if you have brief backgrounds on:

1. R language
2. Eddy covariance
3. Net Ecosystem Exchange

## Software

You would need the software below to perform the steps discussed in the talk.

1. R 
2. RStudio
3. Packages: REddyProc

# Introduction to the REddyProc Package: When Do We Use It?

The REddyProc package become useful after the pre-processing of the raw, high-frequency (10 Hz, 20 Hz, etc.) eddy covariance data. Using software, such as EddyPro, the data was checked using quality-control protocols, e.g., 0-1-2, 0-9 quality flag systems, etc., to discard low-quality fluxes.

We use this package to:

1. Post-process the Net Ecosystem Exchange (NEE) data.
2. Estimate NEE, e.g., the annual sum.
3. Determine the contributions of processes within NEE, e.g., production and respiration.


# Steps in Using REddyProc

There are three main steps in a typical REddyProc analysis workflow. 

1. The REddyProc package is utilized after the pre-processing step in which the fluxes are checked further for under-developed turbulence or low friction velocity ($u_*$).

    * The package can suggest threshold values of $u_*$ and calculate uncertainties in different scenarios.

2. Fill gaps introduced due to the discarding of fluxes below the thresholds.

3. Separating fluxes into groups: Gross Primary Production (GPP) and Ecosystem Resipiration ($R_{eco}$).

You can view more details about the package at https://bgc.iwww.mpg.de/5622399/REddyProc.

# Learning Outcomes

At the end of the talk, you would be able to:

1. Understand the capabilities of the REddyProc package.
2. Explain the analysis steps of the package.

# Step 0: Preliminary Work

## Install the Package

The package needs to be installed prior to use. You might also need to install other packages  to run REddyProc. You can do so by using the `install.packages` command for their installation.

```{r Install Package}
install.packages("REddyProc", repos = "http://cran.us.r-project.org")
```

You will need to load the package after a successful installation. 

```{r Load Package}
library(REddyProc)
```


# Step 1: Prepare the Data

## Step 1-1: Import the Data

The eddy covariance data that will be used in this walk-through are included in the package. They are for demo purposes.

1. `DEGebExample`, the Gebesee, Germany, data from 2004 to 2006. 
2. `Example_DETha98`, the Tharandt, Germany, data for the year 1998. 

The full data is downloadable at http://www.europe-fluxdata.eu/home/ after registration.

Load the Gebesee data.

```{r Load Gebesee Data}
data(DEGebExample)
```

Load the Tharandt data.

```{r Load Tharandt Data}
data(Example_DETha98)
```

# Data Overview: Gebesee

Get an overview of the data. Look at the data parameters and take note of missing data or `NA`.

## The Gebesee, Germany, Data 

### Characteristics

* Surface: Agriculture
* Time zone: +1 GMT
* Latitude, Longitude: 51.1N, 10.9E

Notice that VPD is not in the dataset.

```{r Summary Gebesee}
summary(DEGebExample)
```

# Data Overview: Tharandt

## The Tharandt, Germany, Data

### Characteristics

* Surface: Forest
* Time zone: +2 GMT
* Latitude, Longitude: 51.0N, 13.6E

Note that the timestamp is not in REddyProc-usable format.

```{r Summary Tharandt} 
names(Example_DETha98)
head(Example_DETha98)
```
